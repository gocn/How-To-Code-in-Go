<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="在 Go 中定义方法 # 简介 # 函数允许你将逻辑组织成可重复的程序，每次运行时可以使用不同的参数。在定义函数的过程中，你常常会发现，可能会有多个函数每次对同一块数据进行操作。Go 可以识别这种模式，并允许您定义特殊的函数，称为方法，其目的是对某些特定类型（称为接收器）的实例进行操作。将方法添加到类型中，不仅可以传达数据是什么，还可以传达如何使用这些数据。
定义一个方法 # 定义一个方法的语法与定义一个函数的语法很相似。唯一的区别是在 func 关键字后面增加了一个额外的参数，用于指定方法的接收器。接收器是你希望定义的方法的类型声明。下面的例子为一个结构体类型定义了一个方法。
package main import &#34;fmt&#34; type Creature struct { Name string Greeting string } func (c Creature) Greet() { fmt.Printf(&#34;%s says %s&#34;, c.Name, c.Greeting) } func main() { sammy := Creature{ Name: &#34;Sammy&#34;, Greeting: &#34;Hello!&#34;, } Creature.Greet(sammy) } 如果你运行这段代码，输出将是：
Output Sammy says Hello! 我们创建了一个名为 Creature 的结构，包含字符串类型的 Name 和 Greeting 字段。这个 Creature 结构体有一个定义的方法，即 Greet。在接收器声明中，我们将 Creature 的实例分配给变量 c，以便我们在 fmt.Printf 中打印问候信息时可以引用 Creature 字段。"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="在 Go 中定义方法 # 简介 # 函数允许你将逻辑组织成可重复的程序，每次运行时可以使用不同的参数。在定义函数的过程中，你常常会发现，可能会有多个函数每次对同一块数据进行操作。Go 可以识别这种模式，并允许您定义特殊的函数，称为方法，其目的是对某些特定类型（称为接收器）的实例进行操作。将方法添加到类型中，不仅可以传达数据是什么，还可以传达如何使用这些数据。
定义一个方法 # 定义一个方法的语法与定义一个函数的语法很相似。唯一的区别是在 func 关键字后面增加了一个额外的参数，用于指定方法的接收器。接收器是你希望定义的方法的类型声明。下面的例子为一个结构体类型定义了一个方法。
package main import &#34;fmt&#34; type Creature struct { Name string Greeting string } func (c Creature) Greet() { fmt.Printf(&#34;%s says %s&#34;, c.Name, c.Greeting) } func main() { sammy := Creature{ Name: &#34;Sammy&#34;, Greeting: &#34;Hello!&#34;, } Creature.Greet(sammy) } 如果你运行这段代码，输出将是：
Output Sammy says Hello! 我们创建了一个名为 Creature 的结构，包含字符串类型的 Name 和 Greeting 字段。这个 Creature 结构体有一个定义的方法，即 Greet。在接收器声明中，我们将 Creature 的实例分配给变量 c，以便我们在 fmt.Printf 中打印问候信息时可以引用 Creature 字段。"><meta property="og:type" content="article"><meta property="og:url" content="https://gocn.github.io/How-To-Code-in-Go/docs/34-Defining_Methods_in_Go/"><meta property="article:section" content="docs"><title>34 Defining Methods in Go | How To Code in Go</title><link rel=manifest href=/How-To-Code-in-Go/manifest.json><link rel=icon href=/How-To-Code-in-Go/favicon.png type=image/x-icon><link rel=stylesheet href=/How-To-Code-in-Go/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/How-To-Code-in-Go/flexsearch.min.js></script>
<script defer src=/How-To-Code-in-Go/zh.search.min.2ccdafc211784f64f63652981924d269b4ff643413814bfc0d5743573b76ade7.js integrity="sha256-LM2vwhF4T2T2NlKYGSTSabT/ZDQTgUv8DVdDVzt2rec=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/How-To-Code-in-Go/><span>How To Code in Go</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><p><strong>开始学习</strong></p><ul><li><a href=/How-To-Code-in-Go/docs/01-How_To_Install_Go_and_Set_Up_a_Local-Programming_Environment_on_Ubuntu_18.04_DigitalOcean/>1. 如何在 Ubuntu 18.04 上安装 Go 和设置本地编程环境</a></li><li><a href=/How-To-Code-in-Go/docs/02-How_To_Install_Go_and_Set_Up_a_Local_Programming_Environment_on_macOS_DigitalOcean/>2. 如何在 macOS 上安装 Go 和设置本地编程环境</a></li><li><a href=/How-To-Code-in-Go/docs/03-How_To_Install_Go_and_Set_Up_a_Local_Programming_Environment_on_Windows_10_DigitalOcean/>3. 如何在 Windows 10 上安装 Go 和设置本地编程环境</a></li><li><a href=/How-To-Code-in-Go/docs/04-How_To_Write_Your_First_Program_in_Go_DigitalOcean/>4. 如何用 Go 编写你的第一个程序</a></li><li><a href=/How-To-Code-in-Go/docs/05-Understanding_the_GOPATH/>5. 理解 GOPATH</a></li><li><a href=/How-To-Code-in-Go/docs/06-How_To_Write_Comments_in_Go/>6. 如何在 Go 中写注释</a></li><li><a href=/How-To-Code-in-Go/docs/07-Understanding_Data_Types_in_Go/>7. 理解 Go 的数据类型</a></li><li><a href=/How-To-Code-in-Go/docs/08-An_Introduction_to_Working_with_Strings_in_Go/>8. Go 中处理字符串的介绍</a></li><li><a href=/How-To-Code-in-Go/docs/09-How_To_Format_Strings_in_Go/>9. 如何在 Go 中格式化字符串</a></li><li><a href=/How-To-Code-in-Go/docs/10-An_Introduction_to_the_Strings_Package_in_Go/>10. 介绍 Go 中的 Strings 包</a></li><li><a href=/How-To-Code-in-Go/docs/11-How_To_Use_Variables_and_Constants_in_Go/>11. 如何在 Go 中使用变量和常量</a></li><li><a href=/How-To-Code-in-Go/docs/12-How_To_Convert_Data_Types_in_Go/>12. 如何在 Go 中转换数据类型</a></li><li><a href=/How-To-Code-in-Go/docs/13-How_To_Do_Math_in_Go_with_Operators/>13. 如何用运算符在 Go 中做数学计算</a></li><li><a href=/How-To-Code-in-Go/docs/14-Understanding_Boolean_Logic_in_Go/>14. 理解 Go 中的布尔逻辑</a></li><li><a href=/How-To-Code-in-Go/docs/15-Understanding_Maps_in_Go/>15. 理解 Go 中的 Map</a></li><li><a href=/How-To-Code-in-Go/docs/16-Understanding_Arrays_and_Slices_in_Go/>16. 理解 Go 中的数组和切片</a></li><li><a href=/How-To-Code-in-Go/docs/17-Handling_Errors_in_Go_DigitalOcean/>17. 在 Go 中处理错误</a></li><li><a href=/How-To-Code-in-Go/docs/18-Creating_Custom_Errors_in_Go_DigitalOcean/>18. 在 Go 中创建自定义错误</a></li><li><a href=/How-To-Code-in-Go/docs/19-Handling_Panics_in_Go-_DigitalOcean/>19 在 Go 中处理恐慌</a></li><li><a href=/How-To-Code-in-Go/docs/20-Importing_Packages_in_Go_DigitalOcean/>20. 在 Go 中导入包</a></li><li><a href=/How-To-Code-in-Go/docs/21-How_To_Write_Packages_in_Go/>21. 如何在 Go 中编写包</a></li><li><a href=/How-To-Code-in-Go/docs/22-Understanding_Package_Visibility_in_Go/>22. 理解 Go 中包的可见性</a></li><li><a href=/How-To-Code-in-Go/docs/23-How_To_Write_Conditional_Statements_in_Go/>23. 如何在 Go 中编写条件语句</a></li><li><a href=/How-To-Code-in-Go/docs/24-How_To_Write_Switch_Statements_in_Go/>24. 如何在 Go 中编写 Switch 语句</a></li><li><a href=/How-To-Code-in-Go/docs/25-How_To_Construct_For_Loops_in_Go/>25. 如何在 Go 中构造 for 循环</a></li><li><a href=/How-To-Code-in-Go/docs/26-Using_Break_and_Continue_Statements_When_Working_with_Loops_in_Go/>26. 在循环中使用 Break 和 Continue</a></li><li><a href=/How-To-Code-in-Go/docs/27-How_To_Define_and_Call_Functions_in_Go/>27. 如何在 Go 中定义并调用函数</a></li><li><a href=/How-To-Code-in-Go/docs/28-How_To_Use_Variadic_Functions_in_Go/>28. 如何在 Go 中使用可变参数函数</a></li><li><a href=/How-To-Code-in-Go/docs/29-Understanding_defer_in_Go/>29. 理解 Go 中的 defer</a></li><li><a href=/How-To-Code-in-Go/docs/30-Understanding_init_in_Go/>30. 理解 Go 中的 init</a></li><li><a href=/How-To-Code-in-Go/docs/31-Customizing_Go_Binaries_with_Build_Tags/>31. 用构建标签定制 Go 二进制文件</a></li><li><a href=/How-To-Code-in-Go/docs/32-Understanding_Pointers_in_Go/>32. 理解 Go 中的指针</a></li><li><a href=/How-To-Code-in-Go/docs/33-Defining_Structs_in_Go/>33. 在 Go 中定义结构体</a></li><li><a href=/How-To-Code-in-Go/docs/34-Defining_Methods_in_Go/ class=active>34. 在 Go 中定义方法</a></li><li><a href=/How-To-Code-in-Go/docs/35-How_To_Build_and_Install_Go_Programs/>35. 如何构建和安装 Go 程序</a></li><li><a href=/How-To-Code-in-Go/docs/36-How_To_Use_Struct_Tags_in_Go/>36. 如何在 Go 中使用结构体标签</a></li><li><a href=/How-To-Code-in-Go/docs/37-How_To_Use_Interfaces_in_Go/>37. 如何在 Go 使用 interface</a></li><li><a href=/How-To-Code-in-Go/docs/38-Building_Go_Applications_for_Different_Operating_Systems_and_Architectures/>38. 在不同的操作系统和架构编译 Go 应用</a></li><li><a href=/How-To-Code-in-Go/docs/39-Using_ldflags_to_Set_Version_Information_for_Go_Applications/>39. 用 ldflags 设置 Go 应用程序的版本信息</a></li><li><a href=/How-To-Code-in-Go/docs/40-How_To_Use_the_Flag_Package_in_Go/>40. 在 Go 里面如何使用 Flag 包</a></li><li><a href=/How-To-Code-in-Go/docs/41-How_to_Use_Go_Modules/>41. 如何使用 Go 模块</a></li><li><a href=/How-To-Code-in-Go/docs/42-How_to_Distribute_Go_Modules/>42. 如何分发 Go 模块</a></li><li><a href=/How-To-Code-in-Go/docs/43-How_to_Use_a_Private_Go_Module_in_Your_Own_Project/>43. 如何在自己的项目中使用私有的Go模块</a></li></ul></li><li><p><strong>附录：资源</strong></p></li><li><p><a href=https://github.com/gocn/How-To-Code-in-Go><strong>Fork on Github</strong></a></p></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/How-To-Code-in-Go/svg/menu.svg class=book-icon alt=Menu></label>
<strong>34 Defining Methods in Go</strong>
<label for=toc-control><img src=/How-To-Code-in-Go/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#定义一个方法>定义一个方法</a></li><li><a href=#接口>接口</a></li><li><a href=#指针接收器>指针接收器</a></li><li><a href=#指针接收器和接口>指针接收器和接口</a></li><li><a href=#总结>总结</a></li></ul></nav></aside></header><article class=markdown><h1 id=在-go-中定义方法>在 Go 中定义方法
<a class=anchor href=#%e5%9c%a8-go-%e4%b8%ad%e5%ae%9a%e4%b9%89%e6%96%b9%e6%b3%95>#</a></h1><h2 id=简介>简介
<a class=anchor href=#%e7%ae%80%e4%bb%8b>#</a></h2><p><a href=/How-To-Code-in-Go/docs/27-How_To_Define_and_Call_Functions_in_Go/>函数</a>允许你将逻辑组织成可重复的程序，每次运行时可以使用不同的参数。在定义函数的过程中，你常常会发现，可能会有多个函数每次对同一块数据进行操作。Go 可以识别这种模式，并允许您定义特殊的函数，称为方法，其目的是对某些特定类型（称为接收器）的实例进行操作。将方法添加到类型中，不仅可以传达数据是什么，还可以传达如何使用这些数据。</p><h2 id=定义一个方法>定义一个方法
<a class=anchor href=#%e5%ae%9a%e4%b9%89%e4%b8%80%e4%b8%aa%e6%96%b9%e6%b3%95>#</a></h2><p>定义一个方法的语法与定义一个函数的语法很相似。唯一的区别是在 <code>func</code> 关键字后面增加了一个额外的参数，用于指定方法的接收器。接收器是你希望定义的方法的类型声明。下面的例子为一个结构体类型定义了一个方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Creature</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span>     <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Greeting</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#a6e22e>Creature</span>) <span style=color:#a6e22e>Greet</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s says %s&#34;</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Greeting</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sammy</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Creature</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Name</span>:     <span style=color:#e6db74>&#34;Sammy&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Greeting</span>: <span style=color:#e6db74>&#34;Hello!&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Creature</span>.<span style=color:#a6e22e>Greet</span>(<span style=color:#a6e22e>sammy</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果你运行这段代码，输出将是：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>Sammy says Hello!
</span></span></code></pre></div><p>我们创建了一个名为 <code>Creature</code> 的结构，包含字符串类型的 <code>Name</code> 和 <code>Greeting</code> 字段。这个 <code>Creature</code> 结构体有一个定义的方法，即 <code>Greet</code>。在接收器声明中，我们将 <code>Creature</code> 的实例分配给变量 <code>c</code>，以便我们在 <code>fmt.Printf</code> 中打印问候信息时可以引用 <code>Creature</code> 字段。</p><p>在其他编程语言中，方法调用的接收器通常用一个关键字来表示（例如：<code>this</code> 或 <code>self</code>）。Go 认为接收器和其他变量一样，是一个变量，所以你可以自由地命名。社区对这个参数的首选风格是接收器类型小写版本的第一个字符。在这个例子中，我们使用了 <code>c</code>，因为接收器的类型是 <code>Creature</code>。</p><p>在 <code>main</code> 方法中，我们创建了一个 <code>Creature</code> 实例，并为其 <code>Name</code> 和 <code>Greeting</code> 字段进行赋值。我们在这里调用了 <code>Greet</code> 方法，用 <code>.</code> 连接类型名和方法名，并提供 <code>Creature</code> 实例作为第一个参数。</p><p>Go 提供了另一种更简洁的方式来调用结构体实例的方法，如本例所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Creature</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span>     <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Greeting</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#a6e22e>Creature</span>) <span style=color:#a6e22e>Greet</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s says %s&#34;</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Greeting</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sammy</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Creature</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Name</span>:     <span style=color:#e6db74>&#34;Sammy&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Greeting</span>: <span style=color:#e6db74>&#34;Hello!&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sammy</span>.<span style=color:#a6e22e>Greet</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果你运行这个，输出将与前面的例子相同：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>Sammy says Hello!
</span></span></code></pre></div><p>这个例子与前一个例子相同，但这次我们使用点号来调用 <code>Greet</code> 方法，使用存储在 <code>sammy</code> 变量中的 <code>Creature</code> 作为接收器，这是对第一个例子中的方法调用的简化。标准库和 Go 社区更喜欢这种风格，以至于你很少看到前面所示的方法调用风格。</p><p>下一个例子展示了使用点号比较普遍的一个原因：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Creature</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span>     <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Greeting</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#a6e22e>Creature</span>) <span style=color:#a6e22e>Greet</span>() <span style=color:#a6e22e>Creature</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s says %s!\n&#34;</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Greeting</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>c</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#a6e22e>Creature</span>) <span style=color:#a6e22e>SayGoodbye</span>(<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Farewell&#34;</span>, <span style=color:#a6e22e>name</span>, <span style=color:#e6db74>&#34;!&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sammy</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Creature</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Name</span>:     <span style=color:#e6db74>&#34;Sammy&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Greeting</span>: <span style=color:#e6db74>&#34;Hello!&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sammy</span>.<span style=color:#a6e22e>Greet</span>().<span style=color:#a6e22e>SayGoodbye</span>(<span style=color:#e6db74>&#34;gophers&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Creature</span>.<span style=color:#a6e22e>SayGoodbye</span>(<span style=color:#a6e22e>Creature</span>.<span style=color:#a6e22e>Greet</span>(<span style=color:#a6e22e>sammy</span>), <span style=color:#e6db74>&#34;gophers&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果你运行这段代码，输出看起来像这样：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>Output</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Sammy</span> <span style=color:#a6e22e>says</span> <span style=color:#a6e22e>Hello</span>!!
</span></span><span style=display:flex><span><span style=color:#a6e22e>Farewell</span> <span style=color:#a6e22e>gophers</span> !
</span></span><span style=display:flex><span><span style=color:#a6e22e>Sammy</span> <span style=color:#a6e22e>says</span> <span style=color:#a6e22e>Hello</span>!!
</span></span><span style=display:flex><span><span style=color:#a6e22e>Farewell</span> <span style=color:#a6e22e>gophers</span> !
</span></span></code></pre></div><p>我们修改了前面的例子，引入了另一个名为 <code>SayGoodbye</code> 的方法，并将 <code>Greet</code> 改为返回一个 <code>Creature</code>，这样我们就可以对该实例调用更多的方法。在 <code>main</code> 方法中，我们首先使用点号调用 <code>sammy</code> 变量上的 <code>Greet</code> 和 <code>SayGoodbye</code> 方法，然后使用函数式调用方式。</p><p>两种风格输出的结果相同，但使用点号的例子更易读。点号调用链路还会告诉我们方法被调用的顺序，而函数式则颠倒了这个顺序。在 <code>SayGoodbye</code> 的调用中增加了一个参数，进一步模糊了方法调用的顺序。点号调用的清晰性是 Go 中调用方法的首选风格，无论是在标准库中还是在整个 Go 生态的第三方包中都是如此。</p><p>相对于定义对某些值进行操作的方法，为类型定义方法对 Go 编程语言还有其他特殊意义，方法是接口背后的核心概念。</p><h2 id=接口>接口
<a class=anchor href=#%e6%8e%a5%e5%8f%a3>#</a></h2><p>当你在 Go 中为任何类型定义方法时，该方法会被添加到该类型的方法集中。方法集是与该类型相关联的方法的集合，并被 Go 编译器用来确定某种类型是否可以分配给具有接口类型的变量。接口类型是一种方法的规范，被编译器用来保证一个类型会实现这些方法。任何具有与接口定义中相同名称、相同参数与相同返回值的方法类型都被称为实现了该接口，并允许被分配给具有该接口类型的变量。下面是标准库中 <code>fmt.Stringer</code> 接口的定义。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Stringer</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>一个类型要实现 <code>fmt.Stringer</code> 接口，需要提供一个返回 <code>string</code> 的 <code>String()</code> 方法。实现了这个接口，当你把你的类型实例传递给 <code>fmt</code> 包中定义的函数时，你的类型就可以完全按照你的意愿被打印出来（有时称为 “pretty-printed”）。下面的例子定义了一个实现了这个接口的类型：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Ocean</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Creatures</span> []<span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>o</span> <span style=color:#a6e22e>Ocean</span>) <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Join</span>(<span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>Creatures</span>, <span style=color:#e6db74>&#34;, &#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>header</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>s</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Stringer</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>header</span>, <span style=color:#e6db74>&#34;:&#34;</span>, <span style=color:#a6e22e>s</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>o</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Ocean</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Creatures</span>: []<span style=color:#66d9ef>string</span>{
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#34;sea urchin&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#34;lobster&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#34;shark&#34;</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ocean contains&#34;</span>, <span style=color:#a6e22e>o</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>当你运行该代码时，你会看到这样的输出：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>ocean contains : sea urchin, lobster, shark
</span></span></code></pre></div><p>这个例子定义了一个名为 <code>Ocean</code> 的新结构体类型。<code>Ocean</code> 实现了 <code>fmt.Stringer</code> 接口，因为 <code>Ocean</code> 定义了一个名为 <code>String</code> 的方法，该方法不需要参数，返回一个 <code>string</code>。在 <code>main</code> 方法中，我们定义了一个新的 <code>Ocean</code>，并把它传递给一个 <code>log</code> 函数，该函数首先接收一个 <code>string</code> 来打印，然后是任何实现 <code>fmt.Stringer</code> 的参数。Go 编译器允许我们在这里传递 <code>o</code>，因为 <code>Ocean</code> 实现了 <code>fmt.Stringer</code> 所要求的所有方法。在 <code>log</code> 中，我们使用 <code>fmt.Println</code> ，当它遇到 <code>fmt.Stringer</code> 作为其参数之一时，会调用 <code>Ocean</code> 的 <code>String</code> 方法。</p><p>如果 <code>Ocean</code> 没有实现 <code>String()</code> 方法，Go 会产生一个编译错误，因为 <code>log</code> 方法要求一个 <code>fmt.Stringer</code> 作为其参数。这个错误看起来像这样：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>src/e4/main.go:24:6: cannot use o <span style=color:#f92672>(</span>type Ocean<span style=color:#f92672>)</span> as type fmt.Stringer in argument to log:
</span></span><span style=display:flex><span>        Ocean does not implement fmt.Stringer <span style=color:#f92672>(</span>missing String method<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Go 还将确保提供的 <code>String()</code> 方法与 <code>fmt.Stringer</code> 接口所要求的方法完全一致。如果不匹配，就会产生一个类似这样的错误：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>src/e4/main.go:26:6: cannot use o <span style=color:#f92672>(</span>type Ocean<span style=color:#f92672>)</span> as type fmt.Stringer in argument to log:
</span></span><span style=display:flex><span>        Ocean does not implement fmt.Stringer <span style=color:#f92672>(</span>wrong type <span style=color:#66d9ef>for</span> String method<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                have String<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>                want String<span style=color:#f92672>()</span> string
</span></span></code></pre></div><p>在到目前为止的例子中，我们已经在值接收器上定义了方法。也就是说，如果我们使用方法的功能调用，第一个参数（指的是方法所定义的类型）将是一个该类型的值，而不是一个<a href=/How-To-Code-in-Go/docs/32-Understanding_Pointers_in_Go/>指针</a>。因此，我们对方法实例所做的任何修改都会在方法执行完毕后被丢弃，因为收到的值是数据的副本。此外，我们也可以在一个类型的指针接收器上定义方法。</p><h2 id=指针接收器>指针接收器
<a class=anchor href=#%e6%8c%87%e9%92%88%e6%8e%a5%e6%94%b6%e5%99%a8>#</a></h2><p>在指针接收器上定义方法的语法与在值接收器上定义方法的语法几乎相同。不同的是在接收器声明中用星号（<code>*</code>）作为类型名称的前缀。下面的例子在指针接收器上定义了一个类型的方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Boat</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>occupants</span> []<span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>b</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Boat</span>) <span style=color:#a6e22e>AddOccupant</span>(<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>Boat</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>occupants</span> = append(<span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>occupants</span>, <span style=color:#a6e22e>name</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>b</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>b</span> <span style=color:#a6e22e>Boat</span>) <span style=color:#a6e22e>Manifest</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;The&#34;</span>, <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#e6db74>&#34;has the following occupants:&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>occupants</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;\t&#34;</span>, <span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Boat</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;S.S. DigitalOcean&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>AddOccupant</span>(<span style=color:#e6db74>&#34;Sammy the Shark&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>AddOccupant</span>(<span style=color:#e6db74>&#34;Larry the Lobster&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>Manifest</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>当你运行这个例子时，你会看到以下输出：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>The S.S. DigitalOcean has the following occupants:
</span></span><span style=display:flex><span>	 Sammy the Shark
</span></span><span style=display:flex><span>	 Larry the Lobster
</span></span></code></pre></div><p>这个例子定义了一个包含 <code>Name</code> 和 <code>occupants</code> 的 <code>Boat</code> 类型。我们想规定其他包中的代码只用 <code>AddOccupant</code> 方法来添加乘员，所以我们通过小写字段名的第一个字母使 <code>occupants</code> 字段不被导出。我们还想确保调用 <code>AddOccupant</code> 会导致 <code>Boat</code> 实例被修改，这就是为什么我们通过指针接收器定义 <code>AddOccupant</code>。指针作为一个类型的特定实例的引用，而不是该类型的副本。<code>AddOccupant</code> 将使用 <code>Boat</code> 类型的指针调用，可以保证任何修改都是持久的。</p><p>在 <code>main</code> 方法中，我们定义了一个新的变量 <code>b</code>，它将持有一个指向 <code>Boat</code>（<code>*Boat</code>）的指针。我们在这个实例上调用了两次 <code>AddOccupant</code> 方法来增加两名乘客。<code>Manifest</code> 方法是在<code>Boat</code> 值上定义的，因为在其定义中，接收器被指定为（<code>b Boat</code>）。在 <code>main</code> 方法中，我们仍然能够调用 <code>Manifest</code>，因为 Go 能够自动解引用指针以获得 <code>Boat</code> 值。<code>b.Manifest()</code>在这里等同于 <code>(*b).Manifest()</code>。</p><p>当试图为接口类型的变量赋值时，一个方法是定义在一个指针接收器上还是定义在一个值接收器上有重要的影响。</p><h2 id=指针接收器和接口>指针接收器和接口
<a class=anchor href=#%e6%8c%87%e9%92%88%e6%8e%a5%e6%94%b6%e5%99%a8%e5%92%8c%e6%8e%a5%e5%8f%a3>#</a></h2><p>当你为一个接口类型的变量赋值时，Go 编译器会检查被赋值类型的方法集，以确保它实现了所有接口方法。指针接收器和值接收器的方法集是不同的，因为接收指针的方法可以修改其接收器，而接收值的方法则不能。</p><p>下面的例子演示了定义两个方法：一个在一个类型的指针接收器上，一个在它的值接收器上。然而，只有指针接收器能够满足本例中也定义的接口：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Submersible</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Dive</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Shark</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>isUnderwater</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#a6e22e>Shark</span>) <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>isUnderwater</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s is underwater&#34;</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>Name</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s is on the surface&#34;</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>Name</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Shark</span>) <span style=color:#a6e22e>Dive</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>isUnderwater</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>submerge</span>(<span style=color:#a6e22e>s</span> <span style=color:#a6e22e>Submersible</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>Dive</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Shark</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;Sammy&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>s</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>submerge</span>(<span style=color:#a6e22e>s</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>s</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>当你运行该代码时，你会看到这样的输出：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>Sammy is on the surface
</span></span><span style=display:flex><span>Sammy is underwater
</span></span></code></pre></div><p>这个例子定义了一个叫做 <code>Submersible</code> 的接口，它要求类型实现一个 <code>Dive()</code> 方法。然后我们定义了一个包含 <code>Name</code> 字段 和 <code>isUnderwater</code> 方法的 <code>Shark</code> 类型来跟踪 <code>Shark</code> 的状态。我们在 <code>Shark</code> 的指针接收器上定义了一个 <code>Dive()</code> 方法，将 <code>isUnderwater</code> 修改为 <code>true</code>。我们还定义了值接收器的 <code>String()</code> 方法，这样它就可以使用 <code>fmt.Println</code> 干净利落地打印出 <code>Shark</code> 的状态，方法使用我们之前看过的 <code>fmt.Println</code> 所接收的 <code>fmt.Stringer</code> 接口。我们还使用了一个函数 <code>submerge</code>，它接受一个 <code>Submersible</code> 参数。</p><p>使用 <code>Submersible</code> 接口而不是 <code>*Shark</code> 允许 <code>submerge</code> 方法只依赖于一个类型所提供的行为。这使得 <code>submerge</code> 方法更容易重用，因为你不必为 <code>Submarine</code>、<code>Whale</code> 或任何其他我们还没有想到的未来水生居民编写新的 <code>submerge</code> 方法。只要它们定义了一个 <code>Dive()</code> 方法，就可以和 <code>submerge</code> 方法一起使用。</p><p>在 <code>main</code> 方法中，我们定义了一个变量 <code>s</code>，它是一个指向 <code>Shark</code> 的指针，并立即用 <code>fmt.Println</code> 打印了 <code>s</code>。这展示了输出的第一部分，<code>Sammy is on the surface</code>。我们把 <code>s</code> 传给<code>submerge</code>，然后再次调用 <code>fmt.Println</code>，以 <code>s</code> 为参数，看到输出的第二部分，<code>Sammy is underwater</code>。</p><p>如果我们把 <code>s</code> 改成 <code>Shark</code>而不是 <code>*Shark</code>，Go 编译器会产生错误：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Output
</span></span><span style=display:flex><span>cannot use s <span style=color:#f92672>(</span>type Shark<span style=color:#f92672>)</span> as type Submersible in argument to submerge:
</span></span><span style=display:flex><span>	Shark does not implement Submersible <span style=color:#f92672>(</span>Dive method has pointer receiver<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Go 编译器很好心地告诉我们，<code>Shark</code> 确实有一个 <code>Dive</code> 方法，它只在指针接收器上定义。当你在自己的代码中看到这条信息时，解决方法是在分配值类型的变量前使用 <code>&</code> 操作符，传递一个指向接口类型的指针。</p><h2 id=总结>总结
<a class=anchor href=#%e6%80%bb%e7%bb%93>#</a></h2><p>在 Go 中声明方法与定义接收不同类型变量的函数本质上没有区别。同样，<a href=/How-To-Code-in-Go/docs/32-Understanding_Pointers_in_Go/>使用指针</a>规则也适用。Go 为这种极其常见的函数定义提供了一些便利，并将这些方法收集到可以通过接口类型进行要求的方法集中。有效地使用方法可以让你在代码中使用接口来提高可测试性，并为你的代码的未来读者留下更好的结构。</p><p>如果你想了解更多关于 Go 编程语言的一般信息，请查看我们的 <a href=https://gocn.github.io/How-To-Code-in-Go/>How To Code in Go 系列</a>。</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#定义一个方法>定义一个方法</a></li><li><a href=#接口>接口</a></li><li><a href=#指针接收器>指针接收器</a></li><li><a href=#指针接收器和接口>指针接收器和接口</a></li><li><a href=#总结>总结</a></li></ul></nav></div></aside></main></body></html>